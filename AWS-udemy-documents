IMA & AWS CLI
Bài 12: IAM introduction: Users, Groups, Polices
IAM = identity and Access Management, Global service

Bài 13: IAM Policies
Step 1:
Tìm kiếm IAM trên thanh search -> sau đó click vào Users bên thanh sidebar -> createa user ->
                                * Specify user details -> User name (duyduc) -> tích chọn Provide user access to the AWS Management Console -> User type (tích chọn i want to create an IAM user) -> tích chọn Custom password và đặt mật khẩu và bỏ tích chọn User must create a new password at the next signin -> next

Step 2:
Click chọn Create group -> trong create user group -> User group name -> tích chọn AdministratorAccess -> Create User Group -> sau khi tạo xong sẽ tích chọn admin đã xuất hiện trong Group name -> xuống Tags chọn Add new tag -> key (department) && value-optional (Engineering) 

Step 3:
Sau khi đăng nhập xong có thể quay lại trang dashboard của IAM rồi -> Create trong Account Alias -> để edit lại Sign-in URL for IAM users in this account 

-> Bài học rút ra trong bài này là phân quyền người dùng đã được tạo ra trong IAM user 

Bài 14: IAM Policies
IAM Policies (chính sách IAM) trong AWS được dùng để quản lý quyền truy cập (permissions) cho người dùng, nhóm, hoặc dịch vụ trong hệ thống AWS.

Bài 15: IAM Policies Hands On
// remove quyền của một User
Vào User -> ở phần group click và số 1 ở dưới -> click vào admin -> tích chọn user ở dưới -> sau đó remove => dùng để xoá quyền của một user
// Add thêm quyền cho một User
Vào User đó trong Permisstions policies -> chọn Add permissions -> chọn Attach policies directly -> sẽ xuất hiện Permissions policies (tích chọn quyền theo yêu cầu) -> next
// Có thể tạo group sau đó thêm User đó vào group
vào User groups -> create group -> User group name (đặt tên group) -> ở Attach permissions policies - Optional tích chọn quyền (ví dụ AdministratorAccess) -> Create user group 
-> sau khi tạo xong vào group đã tạo -> chọn Add users -> thêm user vào trong -> click Add users

Bài 16: IAM MFA 
=> Nói về bảo mật 

Bài 17: IAM MFA Hands On
- Vào Account settings bên thanh sidebar trong IAM -> click vào Edit -> sẽ xuất hiện Edit password policy -> custom password

🧪 Bước 1: Truy cập trang quản lý IAM
- Vào AWS Console: https://console.aws.amazon.com/
- Gõ “IAM” trong thanh tìm kiếm và chọn dịch vụ IAM
- Trong sidebar trái, chọn Users
- Nhấp vào tên người dùng (IAM User) mà bạn muốn bật MFA

🧪 Bước 2: Cấu hình MFA
- Trong trang người dùng, chọn tab Security credentials
- Kéo xuống phần Multi-factor authentication (MFA)
- Nhấn Assign MFA device

🧪 Bước 3: Chọn loại thiết bị
- Chọn Authenticator app (ứng dụng xác thực) → Nhấn Next
- Trên màn hình sẽ xuất hiện QR code

🧪 Bước 4: Cài đặt trên điện thoại
- Mở ứng dụng Google Authenticator hoặc Authy
- Chọn “Add account” → Quét mã QR từ AWS Console
- Ứng dụng sẽ tạo ra mã OTP (6 số, thay đổi mỗi 30 giây)

🧪 Bước 5: Xác thực và hoàn tất
- Quay lại AWS Console, nhập hai mã OTP liên tiếp từ app (phải chính xác)
- Nhấn Assign MFA
🎉 Hoàn tất! IAM User đó đã bật MFA.

Bài 18: AWS Access Keys, CLI and SDK
How can users access AWS ?
To access AWS, you have three options
   1. AWS Manament Console (protected by password + MFA)
   2. AWS Command Line Interface (CLI): protected by access keys
   3. AWS Software Developer Kit (SDK) - for code 

Bài 19 + Bài 20 + Bài 21:
How to install AWS CLI for windows , MacOs , Linux
// Documents cài đặt cho 3 nền tảng trên
https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html

Bài 22: AWS CLI Hands On
// Muốn tạo Access key 
👤 Bước 2: Mở trang quản lý IAM

- Trên thanh điều hướng, chọn Services → tìm và chọn IAM.
- Trong thanh sidebar chọn Users.
- Nhấp vào tên người dùng IAM mà bạn muốn tạo Access Key.

🔑 Bước 3: Tạo Access Key
- Trong trang chi tiết của user, chọn tab Security credentials.
- Cuộn xuống phần Access keys.
- Nhấn nút Create access key.
- Trong bước chọn cách dùng:
Nhấn Next và Create access key.

// SSH vào server 
- aws configure
        Access Key ID: {điền Access key đã tạo}
        Secret Access Key: {điền Secret Access Key đã tạo}
        Region (ví dụ: ap-southeast-1)
        Output format (ví dụ: json)
- aws iam list-users // dùng để xem tất cà User 

Bài 24: AWS CloudShell 
Shell một biểu tượng nằm trên thanh header của aws -> click vào nó
- Thao tác các lệnh tương tự như trên Ubuntu Linux

Bài 25: IAM Roles for AWS Services
- IAM Role for AWS Service là một vai trò (role) IAM mà bạn gán cho một dịch vụ AWS (như EC2, Lambda, ECS...) để cấp quyền truy cập đến các dịch vụ AWS khác

Bài 26: IAM Roles Hands On
- Vào Roles của IAM -> chọn Create Roles -> Chọn AWS service -> Use case (chọn dịch vụ như EC2 hoặc Lambda) -> Next
- ở Permissions policies -> tìm kiếm trên thanh search (tuỳ chọn quyền bạn cho dịch vụ đó ví dụ như IAMReading) -> Next

Bài 27: IAM Security Tools
- IAM Security Tools
Dùng để:
* Tạo báo cáo CSV cho toàn bộ IAM user trong tài khoản AWS:
* Lần cuối sử dụng password, access key
* MFA đã bật chưa
* Password cũ, hết hạn chưa…
Mục đích:
- Kiểm tra người dùng có tuân thủ bảo mật không, có đang dùng access key cũ/mất an toàn không.

Bài 28: IAM Security Tools hands On
- Vào User trong IAM - click vào một user bất kỳ -> chon Last Accessed => để xem hành động gần nhất 

Bài 29: IAM Best Practice
- không sử dụng tài khoản root ngoại trừ khi thiết lập tài khoản AWS
- Một người dùng vật lý = Một người dùng AWS
- Chỉ định người dùng vào nhóm và chỉ định quyền cho nhóm
- Tạo mật khẩu mạnh 
- Sử dụng và thực thi việc sử dụng Xác thực đa yếu tố
- Tạo và sử dụng Vai trò để cấp quyền cho các dịch vụ AWS
- Sử dụng Key cập để truy cập theo chương trình
- Kiểm tra quyền của tài khoản của bạn bằng Báo cáo thông tin xác thực IAM & Cố vấn truy cập IAM
- Không bao giờ chia sẻ tài khoản IAM users và Access Keys

Bài 30: IAM Summary 
- Users: mỗi IAM User được tạo ra cho một người thật cụ thể chứ không phải cho ứng dụng hay dịch vụ
- Groups: Groups chỉ chứa Users
- Policies:  JSON dùng để khai báo quyền (permissions) mà một user, group hoặc role được phép thực hiện trên AWS.
- Roles: được tạo ra để EC2 hoặc dịch vụ AWS sử dụng
- Security: MFA + Password Policy
- AWS CLI: quản lý các dịch vụ AWS của bạn bằng cách sử dụng dòng lệnh

// EC2 Fundamentals
Bài 31: AWS Budget Setup
- Vào user root -> click chọn account trên thanh header -> chọn Account -> kéo xuống IAM user and role access -> click chọn Edit -> tích chọn Activate IAM Access -> update
- quay lại User IAM -> nhấn vào Accout và chọn Billing and Cost Management -> 
- bên thanh sidebar -> kéo xuống Budgets -> click Create budget -> ở phần Email recipients (điền Email cần alert vào bên trong) -> Create Budget

Bài 32: EC2 Basics
- EC2 là một trong những sản phẩm phổ biến nhất trong AWS
- EC2 viết tắt của Elastic Compute Cloud (Cơ sở hạ tầng)

1. Renting virtual machines (EC2)
👉 EC2 (Elastic Compute Cloud) cho phép bạn thuê máy ảo (virtual server) để chạy ứng dụng, web, backend...
* Bạn có thể chọn cấu hình CPU, RAM, OS (Linux/Windows)
* Trả phí theo giờ hoặc theo giây
* Tương đương như thuê máy chủ ở trung tâm dữ liệu
🖥️ Ví dụ: Chạy backend Java hoặc webserver Nginx trên EC2.

2. Storing data on virtual drives (EBS)
👉 EBS (Elastic Block Store) là ổ đĩa ảo gắn vào EC2.
* Giống như ổ cứng của máy thật
* Lưu trữ dữ liệu: database, file, app log
* Có thể backup (snapshot), mở rộng dung lượng
💾 Ví dụ: EC2 chạy MySQL, dữ liệu được lưu trên EBS.

3. Distributing load across machines (ELB)
👉 ELB (Elastic Load Balancer) giúp phân phối lưu lượng truy cập đến nhiều EC2.
* Tự động chia tải giữa các server
* Nếu 1 EC2 chết → ELB bỏ qua, chuyển lưu lượng sang EC2 khác
Hỗ trợ HTTP(S), TCP, gRPC,...
🌐 Ví dụ: Website có 3 EC2 → ELB chia đều lượt truy cập.

4. Scaling the services using an auto scaling group (ASG)
👉 ASG (Auto Scaling Group) giúp tự động tăng/giảm số lượng EC2 theo nhu cầu.
* Nếu người dùng tăng → tự tạo thêm EC2
* Nếu ít người dùng → giảm EC2 để tiết kiệm tiền
* Kết hợp với CloudWatch (theo dõi CPU, RAM)
📈 Ví dụ: Tăng EC2 khi CPU > 70% trong 5 phút.

5. EFS là gì?
👉 Amazon EFS là dịch vụ lưu trữ dạng tệp (file storage) có khả năng mở rộng linh hoạt, 
cho phép nhiều EC2 instances cùng truy cập chung một hệ thống file, giống như chia sẻ ổ đĩa mạng (network drive).

1. Operating System (OS): Linux, Windows, or Mac OS
Đây là hệ điều hành bạn cài đặt trên EC2 instance.
AWS hỗ trợ:
- Linux: Amazon Linux, Ubuntu, Red Hat, SUSE, CentOS
- Windows: Windows Server (2016, 2019, 2022…)
- macOS: Mac EC2 dành cho phát triển ứng dụng iOS/macOS (giá rất cao)
- Hệ điều hành quyết định cách bạn cài phần mềm, bảo mật và vận hành hệ thống.

2. How much compute power & cores (CPU)
- Bạn chọn loại EC2 instance (ví dụ: t3.micro, m5.large, c6a.xlarge,…)
- Mỗi loại có số vCPU (virtual CPU) và sức mạnh xử lý khác nhau.
Ví dụ:
    * t2.micro → 1 vCPU
    * m5.large → 2 vCPU
    * c5.4xlarge → 16 vCPU, dành cho xử lý tính toán cao
    💡 CPU càng nhiều, xử lý càng nhanh, nhưng giá cũng tăng.

3. How much random-access memory (RAM)
- Cùng với CPU, mỗi EC2 instance có một lượng RAM (bộ nhớ) cố định.
- RAM giúp chạy ứng dụng, xử lý dữ liệu nhanh.
- Ví dụ:
    * t3.micro: 1 vCPU + 1 GB RAM
    * m5.large: 2 vCPU + 8 GB RAM
    * r6g.4xlarge: 16 vCPU + 128 GB RAM (dành cho hệ thống nhiều bộ nhớ)

4. How much storage space
4.1. Network-attached (EBS & EFS)
- EBS (Elastic Block Store):
  * Ổ đĩa block gắn vào EC2
  * Dùng như ổ cứng C:\ hoặc /dev/xvda
Có thể mở rộng, backup snapshot
- EFS (Elastic File System):
    * File system chia sẻ giữa nhiều EC2
    * Dùng cho ứng dụng cần chia sẻ file hoặc logs

4.2. Hardware (EC2 Instance Store)
- Ổ đĩa vật lý gắn trực tiếp vào máy chủ vật lý chạy EC2
- Nhanh hơn EBS nhưng:
  * Dữ liệu mất khi tắt EC2
  * Không backup được
- Dùng cho cache, dữ liệu tạm thời

5. Network card: speed of the card, Public IP address
- Mỗi EC2 có card mạng ảo, băng thông phụ thuộc loại instance:
    t3.micro → thấp (~5 Mbps)
    c6i.4xlarge → ~10 Gbps
- Bạn có thể gán public IP để truy cập từ Internet.
- Hoặc gán Elastic IP (IP tĩnh) để giữ cố định.

6. Firewall rules: security group
- Security Group là tường lửa ảo cho EC2
* Quy định:
- Cổng nào được mở (22, 80, 443,...)
- Ai được phép truy cập (IP hoặc CIDR)
* Ví dụ:
- Cho phép SSH từ IP bạn: TCP 22, Source: your-IP/32
- Mở web: TCP 80, Source: 0.0.0.0/0

7. Bootstrap script: EC2 User Data
- User Data là shell script hoặc cloud-init bạn chèn vào lúc khởi tạo EC2.
- Nó sẽ tự động chạy 1 lần duy nhất khi EC2 khởi động lần đầu.
- Dùng để:
    Cài app (Apache, Docker…)
    Update hệ thống
    Pull code từ Git

Bài 33: Create an EC2 instance with EC2 User Data to have a Website Hands On
- Vào màn hình console tìm -> EC2 -> Click instances bên thanh sidebar -> chọn launch instances
- Name and tags (EC2_Ubuntu)
- Quick Start (click chọn Ubuntu)
- Key pair name - required (đặt tên instance_Key_DevOps_On_AWS) -> Create key pair
- VPC - required (thay đổi thành devops-vpc bài trước đã tạo)
- Subnet chọn devops-subnet-public2
- Auto-assign public IP (chọn Enable)
- Security group name - required (devops_sg)
- configure storage (1x tăng lên 18) 
- click launch instance để tạo máy chủ

Bài 34: EC2 Instance Types Basics
- Khi bạn tạo một EC2 instance trên AWS, bạn sẽ phải chọn Instance Type – đây là lựa chọn quan trọng vì nó quyết định:

✅ CPU (số lõi, tốc độ)
✅ RAM (bộ nhớ)
✅ Băng thông mạng
✅ Dung lượng lưu trữ tạm thời (nếu có)
✅ Giá tiền bạn sẽ trả theo giờ hoặc theo giây
✅ EC2 Instance Types – Tổng quan cơ bản
EC2 Instance Types được chia thành nhiều "family" (họ), mỗi họ tối ưu cho một mục đích riêng.

🔹 1. General Purpose – Cân bằng CPU, RAM
- Family	Mục đích	Ví dụ loại
- t	Tiết kiệm, tải nhẹ	t2.micro, t3.small
- m	Đa năng	m5.large, m6i.xlarge

📌 Dùng cho webserver, app nhỏ, dev/test

🔹 2. Compute Optimized – Tối ưu CPU
- Family	Mục đích	Ví dụ loại
- c	Tính toán cao, xử lý mạnh	c5.large, c6g.2xlarge

📌 Dùng cho web server có tải cao, xử lý nhiều yêu cầu/người dùng

🔹 3. Memory Optimized – Tối ưu RAM
- Family	Mục đích	Ví dụ loại
- r	RAM lớn cho DB	r5.large, r6g.4xlarge
- x, u	RAM cực lớn	x1e.32xlarge

📌 Dùng cho database, in-memory cache (Redis, Memcached), xử lý dữ liệu lớn

🔹 4. Storage Optimized – Tối ưu IOPS, disk
- Family	Mục đích	Ví dụ loại
- i	SSD cực nhanh	i3.large, i4i.xlarge
- d	HDD lớn	d2.8xlarge

📌 Dùng cho big data, log processing, ElasticSearch

🔹 5. Accelerated Computing – GPU hoặc phần cứng đặc biệt
- Family	Mục đích	Ví dụ loại
- p	GPU cho ML/AI	p3.2xlarge, p4d.24xlarge
- g	GPU cho game, đồ hoạ	g4dn.xlarge
- f	FPGA (logic tùy biến)	f1.2xlarge

📌 Dùng cho training AI/ML, rendering 3D, video, game streaming

🔢 Kích thước instance (Size)
- Mỗi loại family có các size khác nhau:

Ký hiệu	Ý nghĩa
- .micro	Nhỏ nhất (ít RAM, CPU)
- .small, .medium	Trung bình
- .large, .xlarge	Lớn hơn
- 2xlarge, 4xlarge, 8xlarge, v.v.	Gấp nhiều lần về tài nguyên

📌 Ví dụ: t3.micro (1 vCPU, 1GB RAM), m5.2xlarge (8 vCPU, 32GB RAM)

💡 Cách chọn instance type
- Nhu cầu	Instance đề xuất
- Thử nghiệm, dev nhỏ	t2.micro hoặc t3.micro (nằm trong Free Tier)
- Web server vừa	t3.medium hoặc m5.large
- DB MySQL	r5.large hoặc r6g.large
- Dự án AI	p3, g4
- Game server	c5, c6i
- ElasticSearch, log	i3, d2

🧠 Tổng kết
- Họ (family)	Dùng cho
- t, m	Tổng quát
- c	CPU-intensive
- r, x	Memory-intensive
- i, d	Storage-intensive
- p, g, f	GPU, AI/ML, đồ họa

Bài 35: Security Groups && Classic Ports Overview
* Giới thiệu về Security Groups trong AWS
✅ Security Group là gì?
* Security Group là tường lửa ảo (virtual firewall) trong AWS, được gắn vào EC2 hoặc các dịch vụ khác như RDS, Lambda (vPC-based), ENI…

* Nó giúp kiểm soát lưu lượng mạng vào (inbound) và ra (outbound) của tài nguyên AWS theo:

- Giao thức (TCP, UDP, ICMP,…)
- Cổng (Port: 22, 80, 443, …)

* Nguồn hoặc đích (IP, CIDR, Security Group khác)

📦 Đặc điểm chính của Security Group
- Tính năng	Mô tả
- Stateful	Tự động cho phép lưu lượng phản hồi, không cần rule ngược lại
- Chỉ cho phép (allow)	Bạn chỉ có thể cho phép, không có khái niệm “deny”
- Áp dụng theo instance	Có thể gắn 1 hoặc nhiều Security Group vào EC2 instance
- Hoạt động ở layer 4	Kiểm soát theo giao thức và cổng, không theo hostname hay URL

=> Chỉ cho phép từ bên ngoài truy cập vào bên trong khi bạn mở inbounds bên trong EC2


Bài 36: Security Groups Hands On
- Trong EC2 Ubuntu vừa tạo ở phần dưới có Security -> ở phía dưới có Security groups -> có thể nhấn vào để xem các IP và Port đã mở
- bên cạnh thanh sidebar -> Network & Security ở phần Security Groups -> click vào sẽ thấy các Security group đã tạo -> có thể nhấn vào security groups để coi các port nào đã được mở
          -> nếu muốn mở thêm port có thể mở thê port bằng cách Edit inbound rules và add rules để thêm port

Bài 37: SSH Overview
- SSH (Secure Shell) là giao thức mạng mã hóa dùng để:
Truy cập từ xa vào máy chủ (remote login)
Thực thi lệnh trên máy Linux từ xa
Truyền file an toàn qua SFTP hoặc SCP

Bài 38 + 39 + 40 + 41 SSH tools
Bài 42: EC2 Instance Connect 
- Connect bên trong EC2 instance 

Bài 43: EC2 instance Roles Demo
- vào EC2 -> chọn máy chủ cần cấp quyền -> chọn Action -> Security -> chọn Modify IAM ROLE -> IAM role -> chọn Security Groups -> sau đó Update IAM role
=> Là IAM Role được gán cho EC2, giúp EC2 có thể tự động truy cập dịch vụ AWS khác (S3, CloudWatch, DynamoDB, v.v.) mà không cần gán Access Key thủ công.

Bài 44: EC2 instance Purchasing Options
💰 EC2 Instance Purchasing Options – Các lựa chọn mua EC2 trên AWS
AWS cung cấp nhiều hình thức mua và sử dụng EC2 instance để bạn có thể tối ưu chi phí tùy theo nhu cầu:

✅ 1. On-Demand Instances (Trả tiền theo giờ/giây – linh hoạt)
Đặc điểm	Mô tả
💸 Giá cao nhất	Nhưng không cam kết gì cả
⏰ Trả theo giờ hoặc giây	Không cần cam kết lâu dài
📦 Dễ dùng, dễ quản lý	Phù hợp để test, dev, workload không ổn định

👉 Dùng khi bạn cần EC2 ngay lập tức, không rõ thời gian chạy là bao lâu.

✅ 2. Reserved Instances (RI) (Đặt chỗ trước, cam kết sử dụng dài hạn)
Đặc điểm	Mô tả
💰 Giá rẻ hơn On-Demand (~30-72%)	Đổi lại phải cam kết dùng 1 năm hoặc 3 năm
🧾 Trả một phần hoặc toàn bộ trước	Có 3 hình thức thanh toán: No Upfront, Partial, All Upfront
🚫 Không thể hủy	Nhưng có thể đổi loại trong cùng family/zone (convertible RI)

👉 Phù hợp với hệ thống chạy 24/7 như backend, web server cố định.

✅ 3. Spot Instances (Đấu giá – cực rẻ)
Đặc điểm	Mô tả
💸 Giá rẻ hơn rất nhiều (~70-90%)	Nhưng AWS có thể thu hồi bất cứ lúc nào
🚫 Không đảm bảo duy trì 100%	Bạn sẽ bị dừng nếu có người khác trả giá cao hơn
🧠 Dùng cho batch jobs, ML training, CI/CD runners	Những workload tạm thời, không yêu cầu uptime cao

👉 Phù hợp để tiết kiệm chi phí, nếu app có thể tự xử lý khi bị mất máy.

✅ 4. Savings Plans (Linh hoạt hơn Reserved Instances)
Đặc điểm	Mô tả
💸 Cam kết sử dụng một mức tiền cố định/tháng	Ví dụ: cam kết dùng $200 EC2 mỗi tháng trong 1 năm
🔁 Linh hoạt về instance type, size, region	Không khóa cứng như Reserved Instances
📈 Dễ dự đoán ngân sách	Có thể áp dụng với Lambda, Fargate (tùy loại plan)

👉 Phù hợp nếu bạn dùng EC2 thường xuyên nhưng muốn linh hoạt cấu hình.

✅ 5. Dedicated Hosts / Dedicated Instances (Thuê nguyên máy vật lý)
Loại	Mô tả
Dedicated Instance	Máy vật lý chỉ có instance của bạn, nhưng AWS vẫn quản lý
Dedicated Host	Bạn thuê hẳn máy vật lý → tự phân bổ EC2, tự license (VD: Windows, Oracle)

👉 Phù hợp cho tuân thủ bảo mật, yêu cầu license riêng, hoặc hệ thống đặc biệt.

Bài 45: IP Address Charges in AWS
Trong AWS, IP address chủ yếu liên quan đến các địa chỉ sau:

- Public IP (địa chỉ IP công cộng)
- Elastic IP (địa chỉ IP tĩnh công cộng do bạn quản lý)
- Private IP (IP nội bộ trong VPC)

✅ 1. Public IP (Tạm thời – Auto-Assigned)
Khi bạn khởi tạo EC2 mà không gán Elastic IP, AWS sẽ tự cấp một Public IPv4 tạm thời.

⛔ Không bị tính phí
⚠️ Nhưng IP này sẽ thay đổi nếu bạn stop/start lại EC2.
🟢 Miễn phí, nhưng không ổn định (không dùng cho domain hoặc hệ thống cần IP cố định).

✅ 2. Elastic IP (EIP) – IP tĩnh, bạn quản lý
Là địa chỉ IP công cộng cố định gán cho EC2, Load Balancer, NAT Gateway,…

✅ Miễn phí nếu:
IP được gán cho một EC2 đang chạy
Chỉ dùng 1 Elastic IP đầu tiên

💸 Tính phí nếu:
Trường hợp bị tính phí	Chi phí
EIP không gán vào instance nào	$0.005/giờ ($3.6/tháng)
EIP gán vào instance bị tắt (stopped)	~$0.005/giờ
Sử dụng nhiều hơn 1 EIP cùng lúc	~$0.005/giờ cho mỗi EIP thứ 2 trở đi

💡 AWS khuyến khích không giữ IP mà không dùng ⇒ vì vậy sẽ tính phí nếu bạn lãng phí IP.

✅ 3. Private IP (IP nội bộ trong VPC)
Được cấp tự động trong VPC (ví dụ: 10.0.0.0/16, 192.168.0.0/16)
Không bị tính phí

🟢 Miễn phí hoàn toàn – dùng cho giao tiếp nội bộ giữa các EC2, RDS, v.v.

✅ 4. IPv6 Addresses
AWS cung cấp miễn phí các địa chỉ IPv6 (vì IPv6 chưa khan hiếm như IPv4)
Không bị tính phí

Bài 46: Spot instance & Spot Fleet AWS 
1. Spot Instance là gì?
Spot Instance là loại EC2 bạn thuê với giá rẻ hơn rất nhiều (giảm đến 90%) so với On-Demand, bằng cách "đấu giá tài nguyên EC2 nhàn rỗi của AWS".

💰 Giá siêu rẻ, nhưng có thể bị AWS thu hồi bất kỳ lúc nào nếu có người dùng khác trả giá cao hơn hoặc AWS cần lại tài nguyên.

📌 Khi nào nên dùng Spot Instance?
Tình huống	Có nên dùng Spot không?
✅ Xử lý batch job	Rất nên – rẻ và chấp nhận mất
✅ Training AI / ML	Rất nên – tiết kiệm GPU
✅ CI/CD runners	Nên – nếu job có thể chạy lại
❌ Web server production	Không – vì có thể bị dừng
❌ Database, hệ thống cần ổn định	Không – cần uptime cao

💥 Điều gì xảy ra khi bị thu hồi?
AWS sẽ gửi thông báo trước 2 phút (spot instance termination notice)

Bạn có thể dùng script để gracefully shutdown hoặc lưu tiến trình

📊 Ví dụ giá Spot:
Instance Type	On-Demand	Spot Price (ước tính)
t3.large	$0.0832/h	~$0.024/h
c6g.2xlarge	$0.272/h	~$0.081/h
p3.2xlarge (GPU)	$3.06/h	~$0.90/h

🔹 2. Spot Fleet là gì?
Spot Fleet = Tập hợp nhiều Spot Instance + quản lý tự động hóa chọn loại máy và vùng (AZ) để đảm bảo khả năng chạy ổn định nhất với giá rẻ nhất.

Tưởng tượng như một nhóm Spot Instance được AWS quản lý theo chiến lược tối ưu (về giá hoặc dung lượng).

⚙️ Spot Fleet cho phép bạn:
Chọn nhiều loại instance khác nhau (c5.large, m5.large, t3.medium, ...)

Chọn nhiều Availability Zones

AWS sẽ:

Chọn các loại đang rẻ nhất, ổn định nhất

Quản lý việc khởi tạo/thu hồi Spot instance

Có thể dùng cho Auto Scaling Group, chạy ECS, EMR, v.v.

Bài 47: EC2 instances Launch Types Hands On 
- Hands-on các loại Launch Types của EC2 instances trong AWS,
giúp bạn hiểu rõ cách tạo, cấu hình và sử dụng từng loại như On-Demand, Spot, Reserved, Dedicated Host.

🧪 Hands-on 1: Khởi tạo EC2 kiểu On-Demand (UI)
- Truy cập AWS Console → EC2 → Launch Instance
- Chọn AMI: ví dụ Amazon Linux 2023
- Chọn loại máy: t2.micro (Free Tier eligible)
- Storage: giữ mặc định
- Key pair: tạo hoặc chọn sẵn (để SSH vào)
- Security Group: mở port 22 (SSH), 80 (web)
- Chọn Launch Type mặc định là On-Demand
- Nhấn Launch

✅ Xong! Bạn vừa tạo xong một On-Demand EC2.

🧪 Hands-on 2: Tạo Spot Instance
- AWS Console → EC2 → Instances → Launch Instance
- Trong bước chọn instance type, tick vào:

✅ "Request Spot Instances"
- Các bước còn lại giống như On-Demand:
- Chọn AMI, loại máy, key pair, v.v.
Bạn có thể cấu hình thêm:
- Max price (giá cao nhất bạn chịu)
- Duration (thời gian tối đa chạy)
Nhấn Launch

📌 Lưu ý:
Nếu AWS không có tài nguyên rảnh hoặc có người trả giá cao hơn → request không được cấp
Spot có thể bị thu hồi nếu không còn tài nguyên

🧪 Hands-on 3: Reserved Instance (RI)
⚠️ Bạn không tạo instance mới mà mua quyền sử dụng cố định như sau:

Vào EC2 → Reserved Instances → Purchase Reserved Instance
Chọn:
- Instance Type (ví dụ: t3.medium)
Region & AZ
- Term: 1 năm hoặc 3 năm
- Payment: No upfront, Partial, All upfront
Xác nhận thanh toán

➡️ Khi bạn chạy EC2 đúng cấu hình, sẽ được tính giá RI thay vì On-Demand.

🧪 Hands-on 4: Dedicated Host
- EC2 Console → Dedicated Hosts → Allocate Host
Chọn:
- Instance family (ví dụ c6i)
- AZ (Availability Zone)
Host Tenancy
- Sau khi Allocate, quay lại Launch Instance
- Trong Tenancy, chọn Dedicated host
* EC2 sẽ được gán vào host riêng
📌 Phù hợp cho những ai cần host riêng biệt, tuân thủ bảo mật, kiểm soát license (BYOL).

Phần 6: EC2 - Solutions Architect Associate Level

Bài 48: Private vs Public vs Elastic IP
🔹 1. Private IP
- Được gán tự động cho mỗi EC2 trong VPC
- Dạng: 10.x.x.x, 172.x.x.x, 192.168.x.x (giống LAN)
- Chỉ dùng để giao tiếp nội bộ trong cùng VPC (hoặc qua VPN/Peering)
- Không thể truy cập từ Internet nếu chỉ có Private IP

🔹 2. Public IP
- IP công khai, ai trên Internet cũng có thể truy cập
- Gán tự động nếu bạn chọn Auto-assign Public IP khi tạo EC2
- Tuy nhiên, nếu bạn stop/start EC2, public IP có thể đổi
- Không nên dùng public IP nếu bạn cần địa chỉ ổn định

3. Elastic IP (EIP)
- Là Public IP tĩnh (công khai) mà bạn tự quản lý
- Gắn vào EC2 thủ công (hoặc qua script)
- Không đổi IP kể cả khi EC2 stop/start
- Bạn phải trả phí nếu EIP không gắn với instance nào

Bài 49: Private vs Public vs Elastic IP Hands On
- 🔧 BƯỚC 1: Tạo EC2 và kiểm tra Private IP
- Vào EC2 Console → Launch Instance
- AMI: Amazon Linux 2 hoặc Ubuntu
- Instance Type: t2.micro (free tier)
- Network settings:
- VPC: chọn default
- Subnet: chọn bất kỳ
- Auto-assign public IP: disable (không bật)
- Tạo hoặc chọn key pair để SSH
- Launch instance

✅ Sau khi tạo xong:

- Chọn instance → tab Networking
- Xem IP:
- Private IPv4: Ví dụ 10.0.1.5
- Public IP: ❌ Không có

✅ Đây là instance chỉ có IP nội bộ, không SSH được từ Internet.

🔧 BƯỚC 2: Tạo EC2 có Public IP
- Lặp lại bước tạo EC2 như trên
- Ở bước "Network settings":
- Auto-assign Public IP: Enable

✅ Sau khi launch:

- Instance có Private IP: 10.x.x.x
- Có thêm Public IPv4: ví dụ 18.208.123.15

📌 Truy cập SSH:
- ssh -i my-key.pem ec2-user@18.208.123.15
💡 Lưu ý: Nếu stop/start lại instance này, Public IP sẽ thay đổi!

📌 BƯỚC 3: Gán Elastic IP vào EC2
🧱 Bước A: Allocate Elastic IP
- Vào EC2 → Network & Security → Elastic IPs
- Click Allocate Elastic IP
- Chọn Amazon pool → Allocate
- Bạn sẽ thấy 1 Elastic IP ví dụ: 3.91.112.66

🔗 Bước B: Associate Elastic IP với EC2
- Chọn Elastic IP → Actions → Associate Elastic IP
- Resource Type: Instance
- Chọn EC2 cần gán
- Private IP: chọn private IP của EC2 đó
Xác nhận
